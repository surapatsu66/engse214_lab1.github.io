<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENGSE214: Secure Coding Lab - Code & Solutions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #0d1117;
            color: #c9d1d9;
        }
        .container {
            max-width: 80rem;
        }
        .lab-section {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 1rem;
            margin-bottom: 3rem;
            padding: 2rem;
        }
        .code-block {
            font-family: 'Fira Code', monospace;
            background-color: #010409;
            border-radius: 0.5rem;
            padding: 1rem;
            font-size: 0.875rem;
            overflow-x: auto;
            border: 1px solid #30363d;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        .code-block .comment { color: #8b949e; }
        .code-block .keyword { color: #ff7b72; }
        .code-block .function { color: #d2a8ff; }
        .code-block .string { color: #a5d6ff; }
        .code-block .variable { color: #ffa657; }
        .code-block .tag { color: #7ee787; }
        .code-block .attr { color: #79c0ff; }
        .step-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #58a6ff;
            border-bottom: 2px solid #30363d;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        .solution-box {
            background-color: rgba(35, 134, 54, 0.1);
            border: 1px solid rgba(35, 134, 54, 0.4);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        .vulnerable-box {
            background-color: rgba(218, 54, 51, 0.1);
            border: 1px solid rgba(218, 54, 51, 0.4);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto px-4 py-12">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-white">Secure Coding Lab: Source Code & Solutions</h1>
            <p class="text-xl text-gray-400 mt-2">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Workshop ‡∏ß‡∏¥‡∏ä‡∏≤ ENGSE214</p>
        </header>

        <!-- Lab 1: XSS Challenge -->
        <div class="lab-section">
            <h2 class="text-3xl font-bold text-white mb-6 border-b-2 border-blue-500 pb-3"><i class="fas fa-hourglass-half mr-3"></i>Lab 1: Cross-Site Scripting (XSS) Challenge</h2>

            <!-- Starter Code Section -->
            <h3 class="step-title">‡∏ä‡∏∏‡∏î‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (Starter Code)</h3>
            <p class="mb-4">‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Lab 1 ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà XSS ‡∏≠‡∏¢‡∏π‡πà</p>
            
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-lg font-semibold mb-2">üìÑ index.html</h4>
                    <div class="code-block">
                        <pre><code>&lt;!<span class="keyword">DOCTYPE</span> <span class="attr">html</span>&gt;
&lt;<span class="keyword">html</span> <span class="attr">lang</span>="<span class="string">th</span>"&gt;
&lt;<span class="keyword">head</span>&gt;
    &lt;<span class="keyword">title</span>&gt;Simple Comment System&lt;/<span class="keyword">title</span>&gt;
&lt;/<span class="keyword">head</span>&gt;
&lt;<span class="keyword">body</span>&gt;
    &lt;<span class="keyword">h1</span>&gt;‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô&lt;/<span class="keyword">h1</span>&gt;
    &lt;<span class="keyword">div</span> <span class="attr">id</span>="<span class="string">comments-container</span>"&gt;&lt;/<span class="keyword">div</span>&gt;
    &lt;<span class="keyword">hr</span>&gt;
    &lt;<span class="keyword">h2</span>&gt;‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà&lt;/<span class="keyword">h2</span>&gt;
    &lt;<span class="keyword">form</span> <span class="attr">id</span>="<span class="string">comment-form</span>"&gt;
        &lt;<span class="keyword">input</span> <span class="attr">type</span>="<span class="string">text</span>" <span class="attr">id</span>="<span class="string">name-input</span>" <span class="attr">placeholder</span>="<span class="string">‡∏ä‡∏∑‡πà‡∏≠</span>" <span class="attr">required</span>&gt;
        &lt;<span class="keyword">textarea</span> <span class="attr">id</span>="<span class="string">comment-input</span>" <span class="attr">placeholder</span>="<span class="string">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</span>" <span class="attr">required</span>&gt;&lt;/<span class="keyword">textarea</span>&gt;
        &lt;<span class="keyword">button</span> <span class="attr">type</span>="<span class="string">submit</span>"&gt;‡πÇ‡∏û‡∏™‡∏ï‡πå&lt;/<span class="keyword">button</span>&gt;
    &lt;/<span class="keyword">form</span>&gt;
    &lt;<span class="keyword">script</span> <span class="attr">src</span>="<span class="string">app.js</span>"&gt;&lt;/<span class="keyword">script</span>&gt;
&lt;/<span class="keyword">body</span>&gt;
&lt;/<span class="keyword">html</span>&gt;</code></pre>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-2">üìÑ db.json (‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á)</h4>
                    <div class="code-block">
                        <pre><code>{
  <span class="string">"comments"</span>: [
    {
      <span class="string">"id"</span>: <span class="variable">1</span>,
      <span class="string">"name"</span>: <span class="string">"Alice"</span>,
      <span class="string">"text"</span>: <span class="string">"‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÅ‡∏£‡∏Å!"</span>
    }
  ]
}</code></pre>
                    </div>
                    <h4 class="text-lg font-semibold mb-2 mt-4">üìÑ app.js (Vulnerable)</h4>
                    <div class="code-block">
                        <pre><code><span class="comment">// ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà</span>
<span class="keyword">function</span> <span class="function">displayComments</span>(<span class="variable">comments</span>) {
    <span class="keyword">const</span> <span class="variable">commentsContainer</span> = <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">'comments-container'</span>);
    <span class="variable">commentsContainer</span>.<span class="variable">innerHTML</span> = <span class="string">''</span>;
    <span class="variable">comments</span>.<span class="function">forEach</span>(<span class="variable">comment</span> => {
        <span class="keyword">const</span> <span class="variable">commentElement</span> = <span class="variable">document</span>.<span class="function">createElement</span>(<span class="string">'div'</span>);
        <span class="comment">// ‡∏õ‡∏±‡∏ç‡∏´‡∏≤! ‡πÉ‡∏ä‡πâ .innerHTML ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á</span>
        <span class="variable">commentElement</span>.<span class="variable">innerHTML</span> = <span class="string">`&lt;strong&gt;${<span class="variable">comment</span>.<span class="variable">name</span>}:&lt;/strong&gt; ${<span class="variable">comment</span>.<span class="variable">text</span>}`</span>;
        <span class="variable">commentsContainer</span>.<span class="function">appendChild</span>(<span class="variable">commentElement</span>);
    });
}
<span class="comment">// ... (‡∏™‡πà‡∏ß‡∏ô fetch ‡πÅ‡∏•‡∏∞ post data)</span></code></pre>
                    </div>
                </div>
            </div>

            <!-- Solution Section -->
            <h3 class="step-title mt-10">‡πÄ‡∏â‡∏•‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô</h3>
            <div class="vulnerable-box">
                <h4 class="text-xl font-semibold text-red-400 mb-2"><i class="fas fa-bug mr-2"></i>‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h4>
                <p>‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå <code>app.js</code> ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô <code>displayComments()</code> ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ <code>commentElement.innerHTML = ...</code> ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ <code>.innerHTML</code> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ó‡∏£‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (<code>comment.name</code> ‡πÅ‡∏•‡∏∞ <code>comment.text</code>) ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏´‡πâ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î HTML ‡∏´‡∏£‡∏∑‡∏≠ JavaScript ‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÑ‡∏°‡πà‡∏´‡∏ß‡∏±‡∏á‡∏î‡∏µ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏õ‡πâ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÑ‡∏î‡πâ</p>
            </div>

            <div class="solution-box">
                <h4 class="text-xl font-semibold text-green-400 mb-2"><i class="fas fa-shield-alt mr-2"></i>‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: Output Encoding/Sanitization</h4>
                <p class="mb-4">‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡πÄ‡∏ä‡πà‡∏ô <code>&lt;</code>, <code>&gt;</code>) ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô HTML Entities (‡πÄ‡∏ä‡πà‡∏ô <code>&amp;lt;</code>, <code>&amp;gt;</code>) ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡πÑ‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "Sanitize" ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                <h5 class="text-lg font-semibold mb-2">‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏â‡∏•‡∏¢‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö <code>app.js</code></h5>
                <div class="code-block">
                    <pre><code><span class="keyword">document</span>.<span class="function">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, () => {
    <span class="keyword">const</span> <span class="variable">commentsContainer</span> = <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">'comments-container'</span>);
    <span class="keyword">const</span> <span class="variable">commentForm</span> = <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">'comment-form'</span>);
    <span class="keyword">const</span> <span class="variable">nameInput</span> = <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">'name-input'</span>);
    <span class="keyword">const</span> <span class="variable">commentInput</span> = <span class="variable">document</span>.<span class="function">getElementById</span>(<span class="string">'comment-input'</span>);

    <span class="comment">// 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Sanitize ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
    <span class="keyword">const</span> <span class="function">sanitize</span> = (<span class="variable">str</span>) => {
        <span class="keyword">const</span> <span class="variable">temp</span> = <span class="variable">document</span>.<span class="function">createElement</span>(<span class="string">'div'</span>);
        <span class="comment">// .textContent ‡∏à‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</span>
        <span class="variable">temp</span>.<span class="variable">textContent</span> = <span class="variable">str</span>;
        <span class="keyword">return</span> <span class="variable">temp</span>.<span class="variable">innerHTML</span>;
    };

    <span class="keyword">function</span> <span class="function">displayComments</span>(<span class="variable">comments</span>) {
        <span class="variable">commentsContainer</span>.<span class="variable">innerHTML</span> = <span class="string">''</span>;
        <span class="variable">comments</span>.<span class="function">forEach</span>(<span class="variable">comment</span> => {
            <span class="keyword">const</span> <span class="variable">commentElement</span> = <span class="variable">document</span>.<span class="function">createElement</span>(<span class="string">'div'</span>);
            
            <span class="comment">// 2. ‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô sanitize ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</span>
            <span class="keyword">const</span> <span class="variable">safeName</span> = <span class="function">sanitize</span>(<span class="variable">comment</span>.<span class="variable">name</span>);
            <span class="keyword">const</span> <span class="variable">safeText</span> = <span class="function">sanitize</span>(<span class="variable">comment</span>.<span class="variable">text</span>);

            <span class="variable">commentElement</span>.<span class="variable">innerHTML</span> = <span class="string">`&lt;strong&gt;${<span class="variable">safeName</span>}:&lt;/strong&gt; ${<span class="variable">safeText</span>}`</span>;
            <span class="variable">commentsContainer</span>.<span class="function">appendChild</span>(<span class="variable">commentElement</span>);
        });
    }

    <span class="keyword">async function</span> <span class="function">fetchComments</span>() {
        <span class="keyword">const</span> <span class="variable">response</span> = <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">'db.json'</span>);
        <span class="keyword">const</span> <span class="variable">data</span> = <span class="keyword">await</span> <span class="variable">response</span>.<span class="function">json</span>();
        <span class="function">displayComments</span>(<span class="variable">data</span>.<span class="variable">comments</span>);
    }
    
    <span class="comment">// ... (‡∏™‡πà‡∏ß‡∏ô post data ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)</span>
    <span class="function">fetchComments</span>();
});</code></pre>
                </div>
            </div>
        </div>

        <!-- Lab 2: Secure Profile Project -->
        <div class="lab-section">
            <h2 class="text-3xl font-bold text-white mb-6 border-b-2 border-green-500 pb-3"><i class="fas fa-code-branch mr-3"></i>Lab 2: Secure User Profile Project</h2>
            <p class="mb-4">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Lab ‡∏ô‡∏µ‡πâ ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á Clone Repository ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≤‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ Task ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏â‡∏•‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô</p>

            <!-- Task A: IDOR -->
            <h3 class="step-title">Task A: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà Insecure Direct Object References (IDOR)</h3>
            <div class="vulnerable-box">
                <h4 class="text-xl font-semibold text-red-400 mb-2"><i class="fas fa-bug mr-2"></i>‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h4>
                <p>‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå <code>profile.js</code> ‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ ID ‡∏à‡∏≤‡∏Å URL parameter ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏î‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏Ñ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ID ‡πÉ‡∏ô URL ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ</p>
            </div>
            <div class="solution-box">
                <h4 class="text-xl font-semibold text-green-400 mb-2"><i class="fas fa-shield-alt mr-2"></i>‡πÄ‡∏â‡∏•‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</h4>
                <p class="mb-4">‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö ID ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô (‡∏ã‡∏∂‡πà‡∏á‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô <code>localStorage</code> ‡∏´‡∏£‡∏∑‡∏≠ Session) ‡∏Å‡∏±‡∏ö ID ‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡πÉ‡∏ô URL ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏´‡∏£‡∏∑‡∏≠ Redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô</p>
                <div class="code-block">
                    <pre><code><span class="comment">// ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå profile.js</span>
<span class="keyword">document</span>.<span class="function">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, () => {
    <span class="keyword">const</span> <span class="variable">loggedInUser</span> = <span class="variable">JSON</span>.<span class="function">parse</span>(<span class="variable">localStorage</span>.<span class="function">getItem</span>(<span class="string">'loggedInUser'</span>));
    <span class="keyword">const</span> <span class="variable">params</span> = <span class="keyword">new</span> <span class="function">URLSearchParams</span>(<span class="variable">window</span>.<span class="variable">location</span>.<span class="variable">search</span>);
    <span class="keyword">const</span> <span class="variable">requestedId</span> = <span class="variable">params</span>.<span class="function">get</span>(<span class="string">'id'</span>);

    <span class="comment">// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</span>
    <span class="keyword">if</span> (!<span class="variable">loggedInUser</span>) {
        <span class="variable">window</span>.<span class="variable">location</span>.<span class="variable">href</span> = <span class="string">'/login.html'</span>;
        <span class="keyword">return</span>;
    }

    <span class="comment">// **‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç IDOR**</span>
    <span class="comment">// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ID ‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏Å‡∏±‡∏ö ID ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</span>
    <span class="keyword">if</span> (<span class="variable">loggedInUser</span>.<span class="variable">id</span>.<span class="function">toString</span>() !== <span class="variable">requestedId</span>) {
        <span class="variable">document</span>.<span class="variable">body</span>.<span class="variable">innerHTML</span> = <span class="string">'&lt;h1&gt;Access Denied&lt;/h1&gt;'</span>;
        <span class="keyword">return</span>;
    }

    <span class="comment">// ‡∏ñ‡πâ‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡∏à‡∏∂‡∏á‡∏Ñ‡πà‡∏≠‡∏¢ fetch ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</span>
    <span class="function">fetchUserProfile</span>(<span class="variable">requestedId</span>);
});</code></pre>
                </div>
            </div>

            <!-- Task C: Password Hashing -->
             <h3 class="step-title mt-10">Task C: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Password Hashing)</h3>
            <div class="vulnerable-box">
                <h4 class="text-xl font-semibold text-red-400 mb-2"><i class="fas fa-bug mr-2"></i>‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h4>
                <p>‡πÑ‡∏ü‡∏•‡πå <code>auth.js</code> ‡πÅ‡∏•‡∏∞ <code>db.json</code> ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ (Plain Text) ‡∏´‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏• ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
            </div>
            <div class="solution-box">
                <h4 class="text-xl font-semibold text-green-400 mb-2"><i class="fas fa-shield-alt mr-2"></i>‡πÄ‡∏â‡∏•‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</h4>
                <p class="mb-4">‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Hashing ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡πÉ‡∏ô Lab ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ (‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏ä‡πà‡∏ô <code>bcrypt.js</code>)</p>
                <div class="code-block">
                    <pre><code><span class="comment">// ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå auth.js</span>

<span class="comment">// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Hashing ‡∏à‡∏≥‡∏•‡∏≠‡∏á (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</span>
<span class="comment">// ‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡∏à‡∏£‡∏¥‡∏á ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ async ‡πÅ‡∏•‡∏∞‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡πÄ‡∏ä‡πà‡∏ô bcrypt</span>
<span class="keyword">function</span> <span class="function">simpleHash</span>(<span class="variable">password</span>) {
    <span class="keyword">let</span> <span class="variable">hash</span> = <span class="string">"hashed_"</span>;
    <span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="variable">password</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
        <span class="variable">hash</span> += (<span class="variable">password</span>.<span class="function">charCodeAt</span>(<span class="variable">i</span>) % <span class="number">10</span>);
    }
    <span class="keyword">return</span> <span class="variable">hash</span> + <span class="string">"_end"</span>;
}

<span class="comment">// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô register</span>
<span class="keyword">registerForm</span>.<span class="function">addEventListener</span>(<span class="string">'submit'</span>, <span class="keyword">async</span> (<span class="variable">e</span>) => {
    <span class="comment">// ...</span>
    <span class="keyword">const</span> <span class="variable">hashedPassword</span> = <span class="function">simpleHash</span>(<span class="variable">password</span>); <span class="comment">// Hashing ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</span>

    <span class="keyword">const</span> <span class="variable">response</span> = <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">'http://localhost:3000/users'</span>, {
        <span class="comment">// ...</span>
        <span class="variable">body</span>: <span class="variable">JSON</span>.<span class="function">stringify</span>({ <span class="variable">email</span>, <span class="variable">password</span>: <span class="variable">hashedPassword</span> }) <span class="comment">// ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤ hash</span>
    });
    <span class="comment">// ...</span>
});

<span class="comment">// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô login</span>
<span class="keyword">loginForm</span>.<span class="function">addEventListener</span>(<span class="string">'submit'</span>, <span class="keyword">async</span> (<span class="variable">e</span>) => {
    <span class="comment">// ...</span>
    <span class="keyword">const</span> <span class="variable">response</span> = <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">`http://localhost:3000/users?email=${<span class="variable">email</span>}`</span>);
    <span class="keyword">const</span> <span class="variable">users</span> = <span class="keyword">await</span> <span class="variable">response</span>.<span class="function">json</span>();

    <span class="keyword">if</span> (<span class="variable">users</span>.<span class="variable">length</span> > <span class="number">0</span>) {
        <span class="keyword">const</span> <span class="variable">user</span> = <span class="variable">users</span>[<span class="number">0</span>];
        <span class="comment">// ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡πâ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å hash ‡πÅ‡∏•‡πâ‡∏ß</span>
        <span class="keyword">if</span> (<span class="function">simpleHash</span>(<span class="variable">password</span>) === <span class="variable">user</span>.<span class="variable">password</span>) {
            <span class="comment">// Login successful</span>
            <span class="variable">localStorage</span>.<span class="function">setItem</span>(<span class="string">'loggedInUser'</span>, <span class="variable">JSON</span>.<span class="function">stringify</span>(<span class="variable">user</span>));
            <span class="variable">window</span>.<span class="variable">location</span>.<span class="variable">href</span> = <span class="string">`/profile.html?id=${<span class="variable">user</span>.<span class="variable">id</span>}`</span>;
        } <span class="keyword">else</span> {
            <span class="comment">// Invalid password</span>
        }
    }
    <span class="comment">// ...</span>
});</code></pre>
                </div>
            </div>

        </div>
    </div>

    <script>
        function switchTab(tabNumber) {
            document.getElementById('content1').classList.remove('active');
            document.getElementById('content2').classList.remove('active');
            document.getElementById('tab1').classList.remove('active');
            document.getElementById('tab2').classList.remove('active');
            
            document.getElementById('content' + tabNumber).classList.add('active');
            document.getElementById('tab' + tabNumber).classList.add('active');
        }
    </script>

</body>
</html>
